/*
Auto-generated by: https://github.com/pmndrs/gltfjsx
Command: npx gltfjsx@6.2.18 clcok.glb 
*/

import React, { useRef, useState } from "react";
import { useGLTF, useAnimations } from "@react-three/drei";
import { useGSAP } from "@gsap/react";
import gsap from "gsap";
import { useFrame } from "@react-three/fiber";

export function ClockModel(props) {
  const group = useRef();
  const [hour, setHour] = useState(0);
  const [minute, setMinute] = useState(0);
  const minuteHand = useRef();
  const hourHand = useRef();
  useGSAP(() => {
    gsap.to(group.current.scale, {
      x: 12,
      y: 12,
      z: 12,
      duration: 0.001,
      scrollTrigger: {
        trigger: ".food-is-beyond-time",
        start: "top bottom",
        toggleActions: "play none none reverse",
      },
    });
    gsap.fromTo(
      group.current.scale,
      {
        x: 12,
        y: 12,
        z: 12,
      },
      {
        x: 0,
        y: 0,
        z: 0,
        duration: 0.001,
        scrollTrigger: {
          trigger: ".food-is-culture",
          start: "top bottom",
          toggleActions: "play none none reverse",
        },
        immediateRender: false,
      }
    );
  });
  useFrame(() => {
    group.current.rotation.y += 0.01;
    var d = new Date();
    setHour(d.getHours());
    setMinute(d.getMinutes());
    hourHand.current.rotation.y = ((hour % 12) + minute / 60) * (Math.PI / 6);
    minuteHand.current.rotation.y = minute * (Math.PI / 30);
  });
  const { nodes, materials, animations } = useGLTF("/models/clock.glb");
  const { actions } = useAnimations(animations, group);
  return (
    <group
      ref={group}
      {...props}
      dispose={null}
      scale={0}
      position={[3, -0.4, 0]}
    >
      <group name="Scene">
        <group name="Sketchfab_model" rotation={[-Math.PI / 2, 0, 0]}>
          <group name="Root">
            <group name="Obj_Clock">
              <group
                name="Obj_Hand"
                position={[0, -0.022, 0.029]}
                rotation={[0, 0.314, 0]}
                // ref={secondHand}
              >
                <mesh
                  name="Obj_Hand_0"
                  geometry={nodes.Obj_Hand_0.geometry}
                  material={materials.WhiteAndBlack}
                  ref={minuteHand}
                />
              </group>
              <group
                name="Obj_Hand001"
                position={[0, -0.022, 0.029]}
                rotation={[0, 0.026, 0]}
              >
                <mesh
                  name="Obj_Hand001_0"
                  geometry={nodes.Obj_Hand001_0.geometry}
                  material={materials.WhiteAndBlack}
                  ref={hourHand}
                />
              </group>
              <mesh
                name="Obj_Clock_0"
                geometry={nodes.Obj_Clock_0.geometry}
                material={materials.WhiteAndBlack}
              />
            </group>
          </group>
        </group>
      </group>
    </group>
  );
}

useGLTF.preload("/clcok.glb");
